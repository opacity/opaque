{"version":3,"file":"index.js","sources":["../dist-src/streams/fileSourceStream.js","../dist-src/streams/bufferSourceStream.js","../dist-src/core/constants.js","../dist-src/core/helpers.js","../dist-src/core/encryption.js","../dist-src/core/metadata.js","../dist-src/streams/decryptStream.js","../dist-src/streams/downloadStream.js","../dist-src/download.js","../dist-src/streams/encryptStream.js","../dist-src/core/requests/getPlans.js","../dist-src/core/requests/checkPaymentStatus.js","../dist-src/core/requests/createAccount.js","../dist-src/core/requests/metadata.js","../dist-src/core/request.js","../dist-src/streams/uploadStream.js","../dist-src/upload.js","../dist-src/core/account/api/v0/downloadFile.js","../dist-src/core/hashing.js","../dist-src/utils/hashToPath.js","../dist-src/core/account/api/v0/generateSubHDKey.js","../dist-src/core/account/api/v0/getAccountInfo.js","../dist-src/utils/cleanPath.js","../dist-src/core/account/api/v0/getFolderHDKey.js","../dist-src/core/account/api/v0/getFolderLocation.js","../dist-src/core/account/api/v0/getFolderMeta.js","../dist-src/core/account/api/v0/getHandle.js","../dist-src/core/account/api/v0/isPaid.js","../dist-src/core/account/api/v0/register.js","../dist-src/core/account/api/v0/index.js","../dist-src/core/account/file-version.js","../dist-src/core/account/file-entry.js","../dist-src/core/account/folder-entry.js","../dist-src/core/account/folder-meta.js","../dist-src/utils/netQueue.js","../dist-src/core/account/api/v1/setFolderMeta.js","../dist-src/core/account/api/v1/meta/removeFile.js","../dist-src/core/account/api/v1/meta/removeVersion.js","../dist-src/core/account/api/v1/meta/addFile.js","../dist-src/core/account/api/v1/meta/addFolder.js","../dist-src/core/account/api/v1/meta/removeFolder.js","../dist-src/core/account/api/v1/createMetaQueue.js","../dist-src/core/account/api/v1/getFolderMeta.js","../dist-src/core/account/api/v1/buildFullTree.js","../dist-src/core/account/api/v1/createFolder.js","../dist-src/core/account/api/v1/createFolderMeta.js","../dist-src/core/requests/deleteFile.js","../dist-src/core/account/api/v1/deleteVersion.js","../dist-src/core/account/api/v1/deleteFile.js","../dist-src/core/account/api/v1/deleteFolder.js","../dist-src/core/account/api/v1/deleteFolderMeta.js","../dist-src/core/account/api/v1/isExpired.js","../dist-src/core/account/api/v1/login.js","../dist-src/core/account/api/v1/moveFile.js","../dist-src/core/account/api/v1/moveFolder.js","../dist-src/core/account/api/v1/renameFile.js","../dist-src/core/account/api/v1/renameFolder.js","../dist-src/core/requests/renewAccount.js","../dist-src/core/account/api/v1/renewAccount.js","../dist-src/core/requests/upgradeAccount.js","../dist-src/core/account/api/v1/upgradeAccount.js","../dist-src/core/account/api/v1/uploadFile.js","../dist-src/core/account/api/v1/index.js","../dist-src/account.js"],"sourcesContent":["import { Readable } from \"readable-stream\";\nconst DEFAULT_OPTIONS = Object.freeze({\n    objectMode: false\n});\nexport default class FileSourceStream extends Readable {\n    constructor(blob, options) {\n        const opts = Object.assign({}, DEFAULT_OPTIONS, options);\n        console.log(\"Starting file source stream\", blob);\n        super(opts);\n        this.offset = 0;\n        this.options = opts;\n        this.blob = blob;\n        this.reader = new FileReader();\n        this._onChunkRead = this._onChunkRead.bind(this);\n        if (opts.blockSize <= 0) {\n            throw new Error(`Invalid blockSize '${opts.blockSize}' in source stream.`);\n        }\n    }\n    _read() {\n        if (this.reader.readyState !== FileReader.LOADING) {\n            this._readChunkFromBlob();\n        }\n    }\n    _readChunkFromBlob() {\n        const blob = this.blob;\n        const offset = this.offset;\n        const blockSize = this.options.blockSize;\n        const limit = Math.min(offset + blockSize, blob.size);\n        // End stream when file is read in\n        if (offset >= blob.size) {\n            return this.push(null);\n        }\n        const chunk = blob.slice(offset, limit, \"application/octet-stream\");\n        this.offset += blockSize;\n        this.reader.onload = this._onChunkRead;\n        this.reader.readAsArrayBuffer(chunk);\n    }\n    _onChunkRead(event) {\n        const chunk = event.target.result;\n        if (this.push(new Uint8Array(chunk))) {\n            this._read();\n        }\n    }\n}\n","import { Readable } from \"readable-stream\";\nconst DEFAULT_OPTIONS = Object.freeze({\n    objectMode: false\n});\nexport default class BufferSourceStream extends Readable {\n    constructor(data, options) {\n        const opts = Object.assign({}, DEFAULT_OPTIONS, options);\n        super(opts);\n        this.offset = 0;\n        this.options = opts;\n        this.buffer = data.data;\n        if (opts.blockSize <= 0) {\n            throw new Error(`Invalid blockSize '${opts.blockSize}' in source stream.`);\n        }\n    }\n    _read() {\n        let read;\n        do {\n            read = this.push(this._readChunkFromBuffer());\n        } while (read);\n    }\n    _readChunkFromBuffer() {\n        const buf = this.buffer;\n        const offset = this.offset;\n        const blockSize = this.options.blockSize;\n        const limit = Math.min(offset + blockSize, buf.length) - offset;\n        // End stream when file is read in\n        if (offset >= buf.length) {\n            return null;\n        }\n        const slice = buf.slice(offset, offset + limit);\n        this.offset += blockSize;\n        return slice;\n    }\n}\n","export const FILENAME_MAX_LENGTH = 256;\nexport const CURRENT_VERSION = 1;\nexport const IV_BYTE_LENGTH = 16;\nexport const TAG_BYTE_LENGTH = 16;\nexport const TAG_BIT_LENGTH = TAG_BYTE_LENGTH * 8;\nexport const DEFAULT_BLOCK_SIZE = 64 * 1024;\nexport const BLOCK_OVERHEAD = TAG_BYTE_LENGTH + IV_BYTE_LENGTH;\nexport const DEFAULT_PART_SIZE = 128 * (DEFAULT_BLOCK_SIZE + BLOCK_OVERHEAD);\n","import { md as ForgeMd, random as ForgeRandom, util as ForgeUtil } from \"node-forge\";\nimport isBuffer from \"is-buffer\";\nimport FileSourceStream from \"../streams/fileSourceStream\";\nimport BufferSourceStream from \"../streams/bufferSourceStream\";\nimport mime from \"mime/lite\";\nimport { FILENAME_MAX_LENGTH, BLOCK_OVERHEAD, DEFAULT_BLOCK_SIZE, DEFAULT_PART_SIZE } from \"./constants\";\nconst Forge = { md: ForgeMd, random: ForgeRandom, util: ForgeUtil };\nconst ByteBuffer = Forge.util.ByteBuffer;\n// Generate new handle, datamap entry hash and encryption key\n// TODO: Decide on format and derivation\nexport function generateFileKeys() {\n    const hash = Forge.md.sha256\n        .create()\n        .update(Forge.random.getBytesSync(32))\n        .digest().toHex();\n    const key = Forge.md.sha256\n        .create()\n        .update(Forge.random.getBytesSync(32))\n        .digest().toHex();\n    const handle = hash + key;\n    return {\n        hash,\n        key,\n        handle\n    };\n}\n// Return datamap hash and encryption key from handle\n// TODO: Decide on format and derivation\nexport function keysFromHandle(handle) {\n    const bytes = Forge.util.binary.hex.decode(handle);\n    const buf = new ByteBuffer(bytes);\n    const hash = buf.getBytes(32);\n    const key = buf.getBytes(32);\n    return {\n        hash: Forge.util.bytesToHex(hash),\n        key: Forge.util.bytesToHex(key),\n        handle\n    };\n}\nexport function sanitizeFilename(filename) {\n    if (filename.length > FILENAME_MAX_LENGTH) {\n        const l = (FILENAME_MAX_LENGTH / 2) - 2;\n        const start = filename.substring(0, l);\n        const end = filename.substring(filename.length - l);\n        filename = start + \"...\" + end;\n    }\n    return filename;\n}\n// Rudimentary format normalization\nexport function getFileData(file, nameFallback = \"file\") {\n    if (isBuffer(file)) {\n        file = file;\n        return {\n            data: file,\n            size: file.length,\n            name: nameFallback,\n            type: \"application/octet-stream\",\n            reader: BufferSourceStream\n        };\n    }\n    else if (file && file.data && isBuffer(file.data)) {\n        file = file;\n        return {\n            data: file.data,\n            size: file.data.length,\n            name: file.name || nameFallback,\n            type: file.type || mime.getType(file.name) || \"\",\n            reader: BufferSourceStream\n        };\n    }\n    else {\n        // TODO\n        file.reader = FileSourceStream;\n    }\n    return file;\n}\nexport function getMimeType(metadata) {\n    return metadata.type || mime.getType(metadata.name) || \"\";\n}\n// get true upload size, accounting for encryption overhead\nexport function getUploadSize(size, params) {\n    const blockSize = params.blockSize || DEFAULT_BLOCK_SIZE;\n    const blockCount = Math.ceil(size / blockSize);\n    return size + blockCount * BLOCK_OVERHEAD;\n}\n// get\nexport function getEndIndex(uploadSize, params) {\n    const blockSize = params.blockSize || DEFAULT_BLOCK_SIZE;\n    const partSize = params.partSize || DEFAULT_PART_SIZE;\n    const chunkSize = blockSize + BLOCK_OVERHEAD;\n    const chunkCount = Math.ceil(uploadSize / chunkSize);\n    const chunksPerPart = Math.ceil(partSize / chunkSize);\n    const endIndex = Math.ceil(chunkCount / chunksPerPart);\n    return endIndex;\n}\nexport function getBlockSize(params) {\n    if (params && params.blockSize) {\n        return params.blockSize;\n    }\n    else if (params && params.p && params.p.blockSize) {\n        return params.p.blockSize;\n    }\n    else {\n        return DEFAULT_BLOCK_SIZE;\n    }\n}\n","import { cipher as ForgeCipher, md as ForgeMd, util as ForgeUtil, random as ForgeRandom } from \"node-forge\";\nimport { IV_BYTE_LENGTH, TAG_BYTE_LENGTH, TAG_BIT_LENGTH, BLOCK_OVERHEAD } from \"./constants\";\nconst Forge = { cipher: ForgeCipher, md: ForgeMd, util: ForgeUtil, random: ForgeRandom };\nconst ByteBuffer = Forge.util.ByteBuffer;\n// Encryption\nexport function encrypt(key, byteBuffer) {\n    const keyBuf = new ByteBuffer(Buffer.from(key, \"hex\"));\n    const iv = Forge.random.getBytesSync(IV_BYTE_LENGTH);\n    const cipher = Forge.cipher.createCipher(\"AES-GCM\", keyBuf);\n    cipher.start({\n        iv,\n        tagLength: TAG_BIT_LENGTH\n    });\n    cipher.update(byteBuffer);\n    cipher.finish();\n    byteBuffer.clear();\n    byteBuffer.putBuffer(cipher.output);\n    byteBuffer.putBuffer(cipher.mode.tag);\n    byteBuffer.putBytes(iv);\n    return byteBuffer;\n}\nexport function encryptString(key, string, encoding = \"utf8\") {\n    const buf = Forge.util.createBuffer(string, encoding);\n    return encrypt(key, buf);\n}\nexport function encryptBytes(key, bytes) {\n    return encrypt(key, Forge.util.createBuffer(bytes));\n}\n// Decryption\nexport function decrypt(key, byteBuffer) {\n    const keyBuf = new ByteBuffer(Buffer.from(key, \"hex\"));\n    keyBuf.read = 0;\n    byteBuffer.read = byteBuffer.length() - BLOCK_OVERHEAD;\n    const tag = byteBuffer.getBytes(TAG_BYTE_LENGTH);\n    const iv = byteBuffer.getBytes(IV_BYTE_LENGTH);\n    const decipher = Forge.cipher.createDecipher(\"AES-GCM\", keyBuf);\n    byteBuffer.read = 0;\n    byteBuffer.truncate(BLOCK_OVERHEAD);\n    decipher.start({\n        iv,\n        // the type definitions are wrong in @types/node-forge\n        tag: tag,\n        tagLength: TAG_BIT_LENGTH\n    });\n    decipher.update(byteBuffer);\n    if (decipher.finish()) {\n        return decipher.output;\n    }\n    else {\n        return false;\n    }\n}\nexport function decryptBytes(key, bytes) {\n    const buf = new ByteBuffer(bytes);\n    const output = decrypt(key, buf);\n    if (output) {\n        return Forge.util.binary.raw.decode(output.getBytes());\n    }\n    else {\n        return false;\n    }\n}\nexport function decryptString(key, byteBuffer, encoding = \"utf8\") {\n    const output = decrypt(key, byteBuffer);\n    if (output) {\n        return Buffer.from(output.toString()).toString(encoding);\n    }\n    else {\n        throw new Error(\"unable to decrypt\");\n    }\n}\n","import { sanitizeFilename } from \"./helpers\";\nimport { encryptString, decryptString } from \"./encryption\";\nimport { util as ForgeUtil } from \"node-forge\";\nconst Forge = { util: ForgeUtil };\nconst PROTOCOL_VERSION = 1;\nexport function createMetadata(file, opts) {\n    const filename = sanitizeFilename(file.name);\n    const metadata = {\n        name: filename,\n        type: file.type,\n        size: file.size,\n        p: opts\n    };\n    return metadata;\n}\nexport function encryptMetadata(metadata, key) {\n    const encryptedMeta = encryptString(key, JSON.stringify(metadata), \"utf8\");\n    return Forge.util.binary.raw.decode(encryptedMeta.getBytes());\n}\nexport function decryptMetadata(data, key) {\n    const byteStr = Forge.util.binary.raw.encode(data);\n    const byteBuffer = new Forge.util.ByteBuffer(byteStr);\n    const meta = JSON.parse(decryptString(key, byteBuffer));\n    return meta;\n}\n","import { Transform } from \"readable-stream\";\nimport { decryptBytes } from \"../core/encryption\";\nimport { util as ForgeUtil } from \"node-forge\";\nimport { DEFAULT_BLOCK_SIZE, BLOCK_OVERHEAD } from \"../core/constants\";\nimport { getBlockSize } from \"../core/helpers\";\nconst Forge = { util: ForgeUtil };\nconst DEFAULT_OPTIONS = Object.freeze({\n    binaryMode: false,\n    objectMode: true,\n    blockSize: DEFAULT_BLOCK_SIZE\n});\nexport default class DecryptStream extends Transform {\n    constructor(key, options) {\n        const opts = Object.assign({}, DEFAULT_OPTIONS, options);\n        super(opts);\n        this.options = opts;\n        this.key = key;\n        this.iter = 0;\n        this.blockSize = getBlockSize(options);\n    }\n    _transform(chunk, encoding, callback) {\n        const blockSize = this.blockSize;\n        const chunkSize = blockSize + BLOCK_OVERHEAD;\n        const length = chunk.length;\n        for (let offset = 0; offset < length; offset += chunkSize) {\n            const limit = Math.min(offset + chunkSize, length);\n            const buf = chunk.slice(offset, limit);\n            const data = decryptBytes(this.key, buf);\n            if (data) {\n                this.push(data);\n            }\n            else {\n                this.emit(\"error\", \"Error decrypting data block\");\n            }\n        }\n        callback(null);\n    }\n}\n","import Axios from \"axios\";\nimport { Readable } from \"readable-stream\";\nimport { getBlockSize } from \"../core/helpers\";\nimport { DEFAULT_BLOCK_SIZE, BLOCK_OVERHEAD } from \"../core/constants\";\nconst DEFAULT_OPTIONS = Object.freeze({\n    autostart: true,\n    maxParallelDownloads: 1,\n    maxRetries: 0,\n    partSize: 80 * (DEFAULT_BLOCK_SIZE + BLOCK_OVERHEAD),\n    objectMode: false\n});\nexport default class DownloadStream extends Readable {\n    constructor(url, metadata, size, options = {}) {\n        const opts = Object.assign({}, DEFAULT_OPTIONS, options);\n        super(opts);\n        // Input\n        this.options = opts;\n        this.url = url;\n        this.size = size;\n        this.metadata = metadata;\n        // Internal\n        this.chunks = [];\n        this.chunkId = 0;\n        this.pushId = 0;\n        this.bytesDownloaded = 0;\n        this.isDownloadFinished = false;\n        this.ongoingDownloads = 0;\n        this.pushChunk = false;\n        const blockSize = getBlockSize(metadata);\n        const blockCount = opts.partSize / (blockSize + BLOCK_OVERHEAD);\n        if (blockCount !== Math.floor(blockCount)) {\n            this.emit(\"error\", \"options.partSize must be a multiple of blockSize + blockOverhead\");\n        }\n        if (opts.autostart) {\n            this._download();\n        }\n    }\n    _read() {\n        this.pushChunk = true;\n        const attemptDownload = this.ongoingDownloads < this.options.maxParallelDownloads;\n        if (!this.isDownloadFinished && attemptDownload) {\n            this._download();\n        }\n        this._pushChunk();\n    }\n    async _download(chunkIndex) {\n        const size = this.size;\n        const partSize = this.options.partSize;\n        const index = chunkIndex || this.chunks.length;\n        const offset = index * partSize;\n        // TODO: Make sure last byte works to prevent edge case\n        if (offset >= size) {\n            this.isDownloadFinished = true;\n            return;\n        }\n        const limit = Math.min(offset + partSize, size) - offset;\n        const range = `bytes=${offset}-${offset + limit - 1}`;\n        const chunk = {\n            id: this.chunkId++,\n            data: null,\n            offset,\n            limit\n        };\n        try {\n            this.chunks.push(chunk);\n            this.ongoingDownloads++;\n            const download = await Axios.get(this.url + \"/file\", {\n                responseType: \"arraybuffer\",\n                headers: {\n                    range\n                }\n            });\n            chunk.data = new Uint8Array(download.data);\n            this.bytesDownloaded += chunk.data.length;\n            this.ongoingDownloads--;\n            this.emit(\"progress\", this.bytesDownloaded / this.size);\n            this._pushChunk();\n        }\n        catch (error) {\n            this.ongoingDownloads--;\n            this.emit(\"error\", error);\n        }\n        return;\n    }\n    async _afterDownload() {\n    }\n    _pushChunk() {\n        if (!this.pushChunk) {\n            return;\n        }\n        const chunk = this.chunks[this.pushId];\n        if (chunk && chunk.data !== null) {\n            this.pushId++;\n            this.pushChunk = this.push(chunk.data);\n            chunk.data = null;\n            this._pushChunk();\n        }\n        else if (this.ongoingDownloads === 0 && this.isDownloadFinished) {\n            this.push(null);\n        }\n    }\n}\n","import Axios from \"axios\";\nimport { EventEmitter } from \"events\";\nimport { decryptMetadata } from \"./core/metadata\";\nimport { getMimeType, getUploadSize, keysFromHandle } from \"./core/helpers\";\nimport DecryptStream from \"./streams/decryptStream\";\nimport DownloadStream from \"./streams/downloadStream\";\nconst METADATA_PATH = \"/download/metadata/\";\nconst DEFAULT_OPTIONS = Object.freeze({\n    autoStart: true\n});\n/**\n * @internal\n */\nexport default class Download extends EventEmitter {\n    constructor(handle, opts = {}) {\n        super();\n        this.metadata = async () => {\n            if (this._metadata) {\n                return this._metadata;\n            }\n            else {\n                return await this.downloadMetadata();\n            }\n        };\n        this.toBuffer = async () => {\n            const chunks = [];\n            let totalLength = 0;\n            if (typeof Buffer === \"undefined\") {\n                return false;\n            }\n            await this.startDownload();\n            return new Promise(resolve => {\n                this.decryptStream.on(\"data\", (data) => {\n                    chunks.push(data);\n                    totalLength += data.length;\n                });\n                this.decryptStream.once(\"finish\", () => {\n                    resolve(Buffer.concat(chunks, totalLength));\n                });\n            }).catch(err => {\n                throw err;\n            });\n        };\n        this.toFile = async () => {\n            const chunks = [];\n            let totalLength = 0;\n            await this.startDownload();\n            return new Promise(resolve => {\n                this.decryptStream.on(\"data\", (data) => {\n                    chunks.push(data);\n                    totalLength += data.length;\n                });\n                this.decryptStream.once(\"finish\", async () => {\n                    const meta = await this.metadata();\n                    resolve(new File(chunks, meta.name, {\n                        type: getMimeType(meta)\n                    }));\n                });\n            }).catch(err => {\n                throw err;\n            });\n        };\n        this.startDownload = async () => {\n            try {\n                await this.getDownloadURL();\n                await this.downloadMetadata();\n                await this.downloadFile();\n            }\n            catch (e) {\n                this.propagateError(e);\n            }\n        };\n        this.getDownloadURL = async (overwrite = false) => {\n            let req;\n            if (!overwrite && this.downloadURLRequest) {\n                req = this.downloadURLRequest;\n            }\n            else {\n                req = Axios.post(this.options.endpoint + \"/api/v1/download\", {\n                    fileID: this.hash\n                });\n                this.downloadURLRequest = req;\n            }\n            const res = await req;\n            if (res.status === 200) {\n                this.downloadURL = res.data.fileDownloadUrl;\n                return this.downloadURL;\n            }\n        };\n        this.downloadMetadata = async (overwrite = false) => {\n            let req;\n            if (!this.downloadURL) {\n                await this.getDownloadURL();\n            }\n            if (!overwrite && this.metadataRequest) {\n                req = this.metadataRequest;\n            }\n            else {\n                const endpoint = this.options.endpoint;\n                const path = METADATA_PATH + this.hash;\n                req = Axios.get(this.downloadURL + \"/metadata\", {\n                    responseType: \"arraybuffer\"\n                });\n                this.metadataRequest = req;\n            }\n            const res = await req;\n            const metadata = decryptMetadata(new Uint8Array(res.data), this.key);\n            this._metadata = metadata;\n            this.size = getUploadSize(metadata.size, metadata.p || {});\n            return metadata;\n        };\n        this.downloadFile = async () => {\n            if (this.isDownloading) {\n                return true;\n            }\n            this.isDownloading = true;\n            this.downloadStream = new DownloadStream(this.downloadURL, await this.metadata, this.size, this.options);\n            this.decryptStream = new DecryptStream(this.key);\n            this.downloadStream.on(\"progress\", progress => {\n                this.emit(\"download-progress\", {\n                    target: this,\n                    handle: this.handle,\n                    progress: progress\n                });\n            });\n            this.downloadStream\n                .pipe(this.decryptStream);\n            this.downloadStream.on(\"error\", this.propagateError);\n            this.decryptStream.on(\"error\", this.propagateError);\n        };\n        this.finishDownload = (error) => {\n            if (error) {\n                this.propagateError(error);\n            }\n            else {\n                this.emit(\"finish\");\n            }\n        };\n        this.propagateError = (error) => {\n            console.warn(\"Download error: \", error.message || error);\n            process.nextTick(() => this.emit(\"error\", error.message || error));\n        };\n        const options = Object.assign({}, DEFAULT_OPTIONS, opts);\n        const { hash, key } = keysFromHandle(handle);\n        this.options = options;\n        this.handle = handle;\n        this.hash = hash;\n        this.key = key;\n        this.downloadURLRequest = null;\n        this.metadataRequest = null;\n        this.isDownloading = false;\n        if (options.autoStart) {\n            this.startDownload();\n        }\n    }\n}\n","import { Transform } from \"readable-stream\";\nimport { encryptBytes } from \"../core/encryption\";\nimport { util as ForgeUtil } from \"node-forge\";\nconst Forge = { util: ForgeUtil };\nconst DEFAULT_OPTIONS = Object.freeze({\n    objectMode: false\n});\nexport default class EncryptStream extends Transform {\n    constructor(key, options) {\n        const opts = Object.assign({}, DEFAULT_OPTIONS, options);\n        super(opts);\n        this.options = opts;\n        this.key = key;\n    }\n    _transform(data, encoding, callback) {\n        const chunk = encryptBytes(this.key, data);\n        const buf = Forge.util.binary.raw.decode(chunk.getBytes());\n        this.push(buf);\n        callback(null);\n    }\n}\n","import Axios from \"axios\";\n/**\n * get a list of available plans\n *\n * @param endpoint\n *\n * @internal\n */\nexport async function getPlans(endpoint) {\n    return Axios.get(endpoint + \"/plans\");\n}\n","import Axios from \"axios\";\nimport { getPayload } from \"../request\";\n/**\n * check whether a payment has gone through for an account\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to check\n *\n * @internal\n */\nexport async function checkPaymentStatus(endpoint, hdNode) {\n    const payload = {\n        timestamp: Math.floor(Date.now() / 1000)\n    };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/account-data\", signedPayload);\n}\n","import Axios from \"axios\";\nimport { getPayload } from \"../request\";\n/**\n * request the creation of an account\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to create\n * @param metadataKey\n * @param duration - account duration in months\n * @param limit - storage limit in GB\n *\n * @internal\n */\nexport async function createAccount(endpoint, hdNode, metadataKey, duration = 12, limit = 128) {\n    const payload = {\n        metadataKey: metadataKey,\n        durationInMonths: duration,\n        storageLimit: limit\n    };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/accounts\", signedPayload);\n}\n","import Axios from \"axios\";\nimport { getPayload } from \"../request\";\n/**\n * request creating a metadata entry\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to access\n * @param metadataKey - the key associated with the metadata\n *\n * @internal\n */\nexport async function createMetadata(endpoint, hdNode, metadataKey) {\n    const timestamp = Math.floor(Date.now() / 1000);\n    const payload = { timestamp, metadataKey };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/metadata/create\", signedPayload);\n}\n/**\n * request deleting a metadata entry\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to access\n * @param metadataKey - the key associated with the metadata\n *\n * @internal\n */\nexport async function deleteMetadata(endpoint, hdNode, metadataKey) {\n    const timestamp = Math.floor(Date.now() / 1000);\n    const payload = { timestamp, metadataKey };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/metadata/delete\", signedPayload);\n}\n/**\n * request changing a metadata entry\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to access\n * @param metadataKey - the key associated with the metadata\n * @param metadata - the metadata to put\n *\n * @internal\n */\nexport async function setMetadata(endpoint, hdNode, metadataKey, metadata) {\n    const timestamp = Math.floor(Date.now() / 1000);\n    const payload = { timestamp, metadata, metadataKey };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/metadata/set\", signedPayload);\n}\n/**\n * request get of a metadata entry\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to access\n * @param metadataKey - the key associated with the metadata\n *\n * @internal\n */\nexport async function getMetadata(endpoint, hdNode, metadataKey) {\n    const timestamp = Math.floor(Date.now() / 1000);\n    const payload = { timestamp, metadataKey };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/metadata/get\", signedPayload);\n}\n","import FormDataNode from \"form-data\";\nimport * as EthUtil from \"ethereumjs-util\";\nconst POLYFILL_FORMDATA = typeof FormData === \"undefined\";\n/**\n * get a signed payload from an hdkey\n *\n * @param rawPayload - a payload object to be processed and signed\n * @param hdNode = the account to sign with\n * @param key\n *\n * @internal\n */\nexport function getPayload(rawPayload, hdNode, key = \"requestBody\") {\n    const payload = JSON.stringify(rawPayload);\n    const hash = EthUtil.keccak256(payload);\n    const signature = hdNode.sign(hash).toString(\"hex\");\n    const pubKey = hdNode.publicKey.toString(\"hex\");\n    const signedPayload = {\n        signature,\n        publicKey: pubKey,\n        hash: hash.toString(\"hex\")\n    };\n    signedPayload[key] = payload;\n    return signedPayload;\n}\n/**\n * get a signed formdata payload from an hdkey\n *\n * @param rawPayload - a payload object to be processed and signed\n * @param extraPayload - additional (unsigned) payload information\n * @param hdNode - the account to sign with\n * @param key\n *\n * @internal\n */\nexport function getPayloadFD(rawPayload, extraPayload, hdNode, key = \"requestBody\") {\n    // rawPayload.timestamp = Date.now();\n    const payload = JSON.stringify(rawPayload);\n    const hash = EthUtil.keccak256(payload);\n    const signature = hdNode.sign(hash).toString(\"hex\");\n    const pubKey = hdNode.publicKey.toString(\"hex\");\n    // node, buffers\n    if (POLYFILL_FORMDATA) {\n        const data = new FormDataNode();\n        data.append(key, payload);\n        data.append(\"signature\", signature);\n        data.append(\"publicKey\", pubKey);\n        // data.append(\"hash\", hash);\n        if (extraPayload) {\n            Object.keys(extraPayload).forEach(key => {\n                const pl = Buffer.from(extraPayload[key]);\n                data.append(key, pl, {\n                    filename: key,\n                    contentType: \"application/octet-stream\",\n                    knownLength: pl.length\n                });\n            });\n        }\n        return data;\n    }\n    else {\n        const data = new FormData();\n        data.append(key, payload);\n        data.append(\"signature\", signature);\n        data.append(\"publicKey\", pubKey);\n        if (extraPayload) {\n            Object.keys(extraPayload).forEach(key => {\n                data.append(key, new Blob([extraPayload[key].buffer]), key);\n            });\n        }\n        return data;\n    }\n}\nexport { getPlans } from \"./requests/getPlans\";\nexport { checkPaymentStatus } from \"./requests/checkPaymentStatus\";\nexport { createAccount } from \"./requests/createAccount\";\nexport { getMetadata, setMetadata, createMetadata, deleteMetadata } from \"./requests/metadata\";\n","import Axios from \"axios\";\nimport { Writable } from \"readable-stream\";\nimport { getPayload, getPayloadFD } from \"../core/request\";\nimport { getEndIndex } from \"../core/helpers\";\nimport { DEFAULT_PART_SIZE } from \"../core/constants\";\nconst POLYFILL_FORMDATA = typeof FormData === \"undefined\";\nconst PART_MIME = \"application/octet-stream\";\nconst DEFAULT_OPTIONS = Object.freeze({\n    maxParallelUploads: 3,\n    maxRetries: 0,\n    partSize: DEFAULT_PART_SIZE,\n    objectMode: false\n});\nexport default class UploadStream extends Writable {\n    constructor(account, hash, size, endpoint, options) {\n        const opts = Object.assign({}, DEFAULT_OPTIONS, options);\n        super(opts);\n        // Input\n        this.account = account;\n        this.hash = hash;\n        this.endpoint = endpoint;\n        this.options = opts;\n        this.size = size;\n        this.endIndex = getEndIndex(size, opts);\n        // Internal\n        this.bytesUploaded = 0;\n        this.blockBuffer = [];\n        this.partBuffer = [];\n        this.bufferSize = 0;\n        this.ongoingUploads = 0;\n        this.retries = 0;\n        this.partIndex = 0;\n        this.finalCallback = null;\n    }\n    _write(data, encoding, callback) {\n        this.blockBuffer.push(data);\n        this.bufferSize += data.length;\n        if (this.bufferSize >= this.options.partSize) {\n            this._addPart();\n            this._attemptUpload();\n        }\n        callback();\n    }\n    _final(callback) {\n        this.finalCallback = callback;\n        if (this.blockBuffer.length > 0) {\n            this._addPart();\n            this._attemptUpload();\n        }\n        else if (this.ongoingUploads === 0) {\n            this._finishUpload();\n        }\n    }\n    // Flatten inputs into a single ArrayBuffer for sending\n    _addPart() {\n        const blocks = this.blockBuffer;\n        const data = new Uint8Array(this.bufferSize);\n        let offset = 0;\n        do {\n            const block = blocks.shift();\n            data.set(block, offset);\n            offset += block.length;\n        } while (blocks.length > 0);\n        this.partBuffer.push({\n            partIndex: ++this.partIndex,\n            data\n        });\n        this.blockBuffer = [];\n        this.bufferSize = 0;\n    }\n    _attemptUpload() {\n        if (this.ongoingUploads >= this.options.maxParallelUploads) {\n            return;\n        }\n        const part = this.partBuffer.shift();\n        this._upload(part);\n    }\n    _upload(part) {\n        this.ongoingUploads++;\n        // Cork stream when busy\n        if (this.ongoingUploads === this.options.maxParallelUploads) {\n            this.cork();\n        }\n        const data = getPayloadFD({\n            fileHandle: this.hash,\n            partIndex: part.partIndex,\n            endIndex: this.endIndex\n        }, {\n            chunkData: part.data\n        }, this.account);\n        const upload = Axios.post(this.endpoint + \"/api/v1/upload\", data, {\n            headers: data.getHeaders ? data.getHeaders() : {},\n            onUploadProgress: (event) => {\n                return;\n            }\n        })\n            .then(result => {\n            this._afterUpload(part);\n        })\n            .catch(error => {\n            this._uploadError(error, part);\n        });\n    }\n    _afterUpload(part) {\n        this.ongoingUploads--;\n        this.bytesUploaded += part.data.length;\n        this.emit(\"progress\", this.bytesUploaded / this.size);\n        // Upload until done\n        if (this.partBuffer.length > 0) {\n            return this._attemptUpload();\n        }\n        if (this.finalCallback) {\n            // Finish\n            if (this.ongoingUploads === 0) {\n                this._finishUpload();\n            }\n        }\n        else {\n            // Continue\n            process.nextTick(() => this.uncork());\n        }\n    }\n    async _finishUpload() {\n        const confirmUpload = this._confirmUpload.bind(this);\n        const data = getPayload({\n            fileHandle: this.hash\n        }, this.account);\n        let uploadFinished = false;\n        do {\n            uploadFinished = await confirmUpload(data);\n            if (!uploadFinished) {\n                await new Promise(resolve => setTimeout(resolve, 5000));\n            }\n        } while (!uploadFinished);\n        this.finalCallback();\n    }\n    async _confirmUpload(data) {\n        try {\n            const req = Axios.post(this.endpoint + \"/api/v1/upload-status\", data);\n            const res = await req;\n            if (!res.data.missingIndexes || !res.data.missingIndexes.length) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        catch (err) {\n            console.warn(err.message || err);\n            return false;\n        }\n    }\n    _uploadError(error, part) {\n        this.ongoingUploads--;\n        console.warn(\"error\", error);\n        if (this.retries++ < this.options.maxRetries) {\n            console.log(\"retrying\", this.retries, \"of\", this.options.maxRetries);\n            this.partBuffer.push(part);\n            this._attemptUpload();\n            return;\n        }\n        if (this.finalCallback) {\n            this.finalCallback(error);\n        }\n        else {\n            this.emit(\"error\", error);\n            this.end();\n        }\n    }\n}\n","import Axios from \"axios\";\nimport { EventEmitter } from \"events\";\nimport { createMetadata, encryptMetadata } from \"./core/metadata\";\nimport { generateFileKeys, getUploadSize, getFileData, getEndIndex } from \"./core/helpers\";\nimport EncryptStream from \"./streams/encryptStream\";\nimport UploadStream from \"./streams/uploadStream\";\nimport { getPayloadFD } from \"./core/request\";\nconst PART_MIN_SIZE = 1024 * 1024 * 5;\nconst POLYFILL_FORMDATA = typeof FormData === \"undefined\";\nconst DEFAULT_OPTIONS = Object.freeze({\n    autoStart: true\n});\nconst DEFAULT_FILE_PARAMS = {\n    blockSize: 64 * 1024,\n};\n/**\n * @internal\n */\nexport default class Upload extends EventEmitter {\n    constructor(file, account, opts = {}) {\n        super();\n        this.startUpload = async () => {\n            try {\n                await this.uploadMetadata();\n                await this.uploadFile();\n            }\n            catch (e) {\n                this.propagateError(e);\n            }\n        };\n        this.uploadMetadata = async () => {\n            const meta = createMetadata(this.data, this.options.params);\n            const encryptedMeta = encryptMetadata(meta, this.key);\n            const data = getPayloadFD({\n                fileHandle: this.hash,\n                fileSizeInByte: this.uploadSize,\n                endIndex: getEndIndex(this.uploadSize, this.options.params)\n            }, {\n                metadata: encryptedMeta\n            }, this.account);\n            const url = this.options.endpoint + \"/api/v1/init-upload\";\n            const headers = data.getHeaders ? data.getHeaders() : {};\n            const req = Axios.post(url, data, { headers });\n            const res = await req;\n            this.emit(\"metadata\", meta);\n        };\n        this.uploadFile = async () => {\n            const readStream = new this.data.reader(this.data, this.options.params);\n            this.readStream = readStream;\n            this.encryptStream = new EncryptStream(this.key, this.options.params);\n            this.uploadStream = new UploadStream(this.account, this.hash, this.uploadSize, this.options.endpoint, this.options.params);\n            this.uploadStream.on(\"progress\", progress => {\n                this.emit(\"upload-progress\", {\n                    target: this,\n                    handle: this.handle,\n                    progress\n                });\n            });\n            this.readStream\n                .pipe(this.encryptStream)\n                .pipe(this.uploadStream)\n                .on(\"finish\", this.finishUpload);\n            this.readStream.on(\"error\", this.propagateError);\n            this.encryptStream.on(\"error\", this.propagateError);\n            this.uploadStream.on(\"error\", this.propagateError);\n        };\n        this.finishUpload = async () => {\n            this.emit(\"finish\", {\n                target: this,\n                handle: this.handle,\n                metadata: this.metadata\n            });\n        };\n        this.propagateError = (error) => {\n            process.nextTick(() => this.emit(\"error\", error));\n        };\n        const options = Object.assign({}, DEFAULT_OPTIONS, opts);\n        options.params = Object.assign({}, DEFAULT_FILE_PARAMS, options.params || {});\n        const { handle, hash, key } = generateFileKeys();\n        const data = getFileData(file, handle);\n        const size = getUploadSize(data.size, options.params);\n        this.account = account;\n        this.options = options;\n        this.data = data;\n        this.uploadSize = size;\n        this.key = key; // Encryption key\n        this.hash = hash; // Datamap entry hash\n        this.handle = handle; // File handle - hex(hash) + hex(key)\n        this.metadata = createMetadata(data, options.params);\n        if (options.autoStart) {\n            this.startUpload();\n        }\n    }\n}\n","import Download from \"../../../../download\";\nconst downloadFile = (masterHandle, handle) => {\n    return new Download(handle, masterHandle.downloadOpts);\n};\nexport { downloadFile };\n","import { soliditySha3 } from \"web3-utils\";\nexport const hash = (...val) => {\n    return soliditySha3(...val).replace(/^0x/, \"\");\n};\n","const hashToPath = (h, { prefix = false } = {}) => {\n    if (h.length % 4) {\n        throw new Error(\"hash length must be multiple of two bytes\");\n    }\n    return (prefix ? \"m/\" : \"\") + h.match(/.{1,4}/g).map(p => parseInt(p, 16)).join(\"'/\") + \"'\";\n};\nexport { hashToPath };\n","import { hash } from \"../../../../core/hashing\";\nimport { hashToPath } from \"../../../../utils/hashToPath\";\nconst generateSubHDKey = (masterHandle, pathString) => {\n    const path = hashToPath(hash(pathString), { prefix: true });\n    return masterHandle.derive(path);\n};\nexport { generateSubHDKey };\n","import { checkPaymentStatus } from \"../../../../core/requests/checkPaymentStatus\";\nconst getAccountInfo = async (masterHandle) => ((await checkPaymentStatus(masterHandle.uploadOpts.endpoint, masterHandle)).data.account);\nexport { getAccountInfo };\n","// TODO: don't use polyfill\nimport { posix } from \"path-browserify\";\nconst posixSep = new RegExp(posix.sep + \"+\", \"g\");\nconst posixSepEnd = new RegExp(\"(.)\" + posix.sep + \"+$\");\n// NOTE: win32 isn't included in the polyfill\nconst win32Sep = new RegExp(\"\\\\+\", \"g\");\nconst trimTrailingSep = (path) => {\n    return path.replace(posixSepEnd, \"$1\");\n};\nconst cleanPath = (path) => {\n    return trimTrailingSep(path.replace(win32Sep, posix.sep).replace(posixSep, posix.sep));\n};\nexport { cleanPath };\n","import { generateSubHDKey } from \"./generateSubHDKey\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst getFolderHDKey = (masterHandle, dir) => {\n    dir = cleanPath(dir);\n    return generateSubHDKey(masterHandle, \"folder: \" + dir);\n};\nexport { getFolderHDKey };\n","import { hash } from \"../../../../core/hashing\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst getFolderLocation = (masterHandle, dir) => {\n    dir = cleanPath(dir);\n    return hash(masterHandle.getFolderHDKey(dir).publicKey.toString(\"hex\"));\n};\nexport { getFolderLocation };\n","import { util as ForgeUtil } from \"node-forge\";\nimport { hash } from \"../../../../core/hashing\";\nimport { getMetadata } from \"../../../../core/requests/metadata\";\nimport { decrypt } from \"../../../../core/encryption\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst getFolderMeta = async (masterHandle, dir) => {\n    dir = cleanPath(dir);\n    const folderKey = masterHandle.getFolderHDKey(dir), location = masterHandle.getFolderLocation(dir), key = hash(folderKey.privateKey.toString(\"hex\")), \n    // TODO: verify folder can only be read by the creating account\n    response = await getMetadata(masterHandle.uploadOpts.endpoint, masterHandle, \n    // folderKey,\n    location);\n    try {\n        // TODO\n        // I have no idea why but the decrypted is correct hex without converting\n        const metaString = decrypt(key, new ForgeUtil.ByteBuffer(Buffer.from(response.data.metadata, \"hex\"))).toString();\n        try {\n            const meta = JSON.parse(metaString);\n            return meta;\n        }\n        catch (err) {\n            console.error(err);\n            console.info(\"META STRING:\", metaString);\n            throw new Error(\"metadata corrupted\");\n        }\n    }\n    catch (err) {\n        console.error(err);\n        throw new Error(\"error decrypting meta\");\n    }\n};\nexport { getFolderMeta };\n","const getHandle = (masterHandle) => {\n    return masterHandle.privateKey.toString(\"hex\") + masterHandle.chainCode.toString(\"hex\");\n};\nexport { getHandle };\n","import { checkPaymentStatus } from \"../../../../core/requests/checkPaymentStatus\";\nconst isPaid = async (masterHandle) => {\n    try {\n        const accountInfoResponse = await checkPaymentStatus(masterHandle.uploadOpts.endpoint, masterHandle);\n        return accountInfoResponse.data.paymentStatus == \"paid\";\n    }\n    catch {\n        return false;\n    }\n};\nexport { isPaid };\n","import { checkPaymentStatus } from \"../../../../core/requests/checkPaymentStatus\";\nimport { createAccount } from \"../../../../core/requests/createAccount\";\nconst register = async (masterHandle, duration, limit) => {\n    if (await masterHandle.isPaid()) {\n        return {\n            data: { invoice: { cost: 0, ethAddress: \"0x0\" } },\n            waitForPayment: async () => ({ data: (await checkPaymentStatus(masterHandle.uploadOpts.endpoint, masterHandle)).data })\n        };\n    }\n    const createAccountResponse = await createAccount(masterHandle.uploadOpts.endpoint, masterHandle, masterHandle.getFolderLocation(\"/\"), duration, limit);\n    return {\n        data: createAccountResponse.data,\n        waitForPayment: () => new Promise(resolve => {\n            const interval = setInterval(async () => {\n                // don't perform run if it takes more than 5 seconds for response\n                const time = Date.now();\n                if (await masterHandle.isPaid() && time + 5 * 1000 > Date.now()) {\n                    clearInterval(interval);\n                    await masterHandle.login();\n                    resolve({ data: (await checkPaymentStatus(masterHandle.uploadOpts.endpoint, masterHandle)).data });\n                }\n            }, 10 * 1000);\n        })\n    };\n};\nexport { register };\n","import { downloadFile } from \"../v0/downloadFile\";\nimport { generateSubHDKey } from \"../v0/generateSubHDKey\";\nimport { getAccountInfo } from \"../v0/getAccountInfo\";\nimport { getFolderHDKey } from \"../v0/getFolderHDKey\";\nimport { getFolderLocation } from \"../v0/getFolderLocation\";\nimport { getFolderMeta } from \"../v0/getFolderMeta\";\nimport { getHandle } from \"../v0/getHandle\";\nimport { isPaid } from \"../v0/isPaid\";\nimport { register } from \"../v0/register\";\nexport { downloadFile, generateSubHDKey, getAccountInfo, getFolderHDKey, getFolderLocation, getFolderMeta, getHandle, isPaid, register };\n/**\n * internal API v0\n *\n * @internal\n */\nconst v0 = {\n    downloadFile,\n    generateSubHDKey,\n    getAccountInfo,\n    getFolderHDKey,\n    getFolderLocation,\n    getFolderMeta,\n    getHandle,\n    isPaid,\n    register\n};\nexport default v0;\n","/**\n * metadata to describe a version of a file as it relates to a filesystem\n *\n * @public\n */\nclass FileVersion {\n    /**\n     * create metadata for a file version\n     *\n     * @param handle - the file handle\n     * @param size - the size of the file in bytes\n     * @param created - the date this version was uploaded\n     * @param modified - the date the filesystem marked as last modified\n     */\n    constructor({ handle, size, created = Date.now(), modified = Date.now() }) {\n        /** @internal */\n        this.minify = () => new MinifiedFileVersion([\n            this.handle,\n            this.size,\n            this.created,\n            this.modified\n        ]);\n        this.handle = handle;\n        this.size = size;\n        this.created = created;\n        this.modified = modified;\n    }\n}\n/**\n * @internal\n */\nclass MinifiedFileVersion extends Array {\n    constructor([handle, size, created, modified]) {\n        super(4);\n        this.unminify = () => new FileVersion({\n            handle: this[0],\n            size: this[1],\n            created: this[2],\n            modified: this[3]\n        });\n        this[0] = handle;\n        this[1] = size;\n        this[2] = created;\n        this[3] = modified;\n    }\n}\nexport { FileVersion, MinifiedFileVersion };\n","import { FileVersion, MinifiedFileVersion } from \"./file-version\";\n/**\n * metadata to describe a file as it relates to the UI\n *\n * @public\n */\nclass FileEntryMeta {\n    /**\n     * create metadata for a file entry in the UI\n     *\n     * @param name - the name of the file as shown in the UI\n     * @param created - the date in `ms` that this file was initially uploaded\n     * @param created - the date in `ms` that the newest version of this file was uploaded\n     * @param versions - versions of the uploaded file (the most recent of which should be the current version of the file)\n     */\n    constructor({ name, created = Date.now(), modified = Date.now(), versions = [] }) {\n        /** @internal */\n        this.minify = () => new MinifiedFileEntryMeta([\n            this.name,\n            this.created,\n            this.modified,\n            this.versions.map(version => new FileVersion(version).minify())\n        ]);\n        this.name = name;\n        this.created = created;\n        this.modified = modified;\n        this.versions = versions;\n    }\n}\n/**\n * @internal\n */\nclass MinifiedFileEntryMeta extends Array {\n    constructor([name, created, modified, versions]) {\n        super(4);\n        this.unminify = () => new FileEntryMeta({\n            name: this[0],\n            created: this[1],\n            modified: this[2],\n            versions: this[3].map(version => new MinifiedFileVersion(version).unminify())\n        });\n        this[0] = name;\n        this[1] = created;\n        this[2] = modified;\n        this[3] = versions;\n    }\n}\nexport { FileEntryMeta, MinifiedFileEntryMeta };\n","/**\n * metadata to describe where a folder can be found (for root metadata of an account)\n *\n * @public\n */\nclass FolderEntryMeta {\n    /**\n     * create metadata entry for a folder\n     *\n     * @param name - a name of the folder shown in the UI\n     * @param location - the public key for the metadata file\n     *   it is how the file will be queried for (using the same system as for the account metadata)\n     */\n    constructor({ name, location }) {\n        /** @internal */\n        this.minify = () => new MinifiedFolderEntryMeta([\n            this.name,\n            this.location\n        ]);\n        this.name = name;\n        this.location = location;\n    }\n}\n/**\n * @internal\n */\nclass MinifiedFolderEntryMeta extends Array {\n    constructor([name, location]) {\n        super(2);\n        this.unminify = () => new FolderEntryMeta({\n            name: this[0],\n            location: this[1]\n        });\n        this[0] = name;\n        this[1] = location;\n    }\n}\nexport { FolderEntryMeta, MinifiedFolderEntryMeta };\n","import { FileEntryMeta, MinifiedFileEntryMeta } from \"./file-entry\";\nimport { FolderEntryMeta, MinifiedFolderEntryMeta } from \"./folder-entry\";\n/**\n * metadata to describe a folder for the UI\n *\n * @public\n */\nclass FolderMeta {\n    /**\n     * create metadata for a folder\n     *\n     * @param name - a nickname shown on the folder when accessed without adding to account metadata\n     * @param files - the files included only in the most shallow part of the folder\n     * @param created - when the folder was created (if not created now) in `ms`\n     * @param created - when the folder was changed (if not modified now) in `ms`\n     */\n    constructor({ name = \"Folder\", files = [], folders = [], created = Date.now(), modified = Date.now() } = {}) {\n        /** @internal */\n        this.minify = () => new MinifiedFolderMeta([\n            this.name,\n            this.files.map(file => new FileEntryMeta(file).minify()),\n            this.folders.map(folder => new FolderEntryMeta(folder).minify()),\n            this.created,\n            this.modified\n        ]);\n        this.name = name;\n        this.files = files;\n        this.folders = folders;\n        this.created = created;\n        this.modified = modified;\n    }\n}\n/**\n * @internal\n */\nclass MinifiedFolderMeta extends Array {\n    constructor([name, files, folders, created, modified]) {\n        super(5);\n        this.unminify = () => new FolderMeta({\n            name: this[0],\n            files: this[1].map(file => new MinifiedFileEntryMeta(file).unminify()),\n            folders: this[2].map(folder => new MinifiedFolderEntryMeta(folder).unminify()),\n            created: this[3],\n            modified: this[4]\n        });\n        this[0] = name;\n        this[1] = files;\n        this[2] = folders;\n        this[3] = created;\n        this[4] = modified;\n    }\n}\nexport { FolderMeta, MinifiedFolderMeta };\n","import { EventEmitter } from \"events\";\nimport debounce from \"debounce\";\nclass NetQueue extends EventEmitter {\n    constructor({ fetch, update, data = {}, timeout = 1000 }) {\n        super();\n        this.updating = false;\n        this.queue = [];\n        this.types = {};\n        this.data = {};\n        this.push = ({ type, payload }) => {\n            this.queue.push({ type, payload });\n            this._process();\n        };\n        this.addType = ({ type, handler }) => {\n            this.types[type] = handler;\n        };\n        this._process = debounce(async () => {\n            if (this.updating)\n                return;\n            this.updating = true;\n            const queueCopy = Object.assign([], this.queue);\n            this.result = await Promise.resolve(this._fetch());\n            for (let { type, payload } of queueCopy) {\n                if (this.types[type])\n                    this.result = await Promise.resolve(this.types[type](this.result, payload));\n                else\n                    throw new Error(\"unknown type: \" + type);\n                this.queue.shift();\n            }\n            await Promise.resolve(this._update(this.result));\n            this.updating = false;\n            this.emit(\"update\", this.result);\n            if (this.queue.length)\n                this._process();\n        }, this._timeout);\n        this._fetch = fetch;\n        this._update = update;\n        this.data = data;\n        this._timeout = timeout;\n    }\n}\nexport { NetQueue };\n","import { hash } from \"../../../hashing\";\nimport { encryptString } from \"../../../encryption\";\nimport { setMetadata } from \"../../../requests/metadata\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst setFolderMeta = async (masterHandle, dir, folderMeta) => {\n    dir = cleanPath(dir);\n    const folderKey = masterHandle.getFolderHDKey(dir), key = hash(folderKey.privateKey.toString(\"hex\")), metaString = JSON.stringify(folderMeta.minify()), encryptedMeta = Buffer.from(encryptString(key, metaString, \"utf8\").toHex(), \"hex\").toString(\"base64\");\n    // TODO: verify folder can only be changed by the creating account\n    await setMetadata(masterHandle.uploadOpts.endpoint, masterHandle, \n    // masterHandle.getFolderHDKey(dir),\n    masterHandle.getFolderLocation(dir), encryptedMeta);\n};\nexport { setFolderMeta };\n","const removeFile = async (metaQueue, meta, file) => {\n    // precondition for if file is no longer in the metadata\n    if (!meta.files.find(f => file === f || file.name === f.name))\n        return meta;\n    meta.files = meta.files.filter(f => file !== f && file.name !== f.name);\n    return meta;\n};\nexport { removeFile };\n","const removeVersion = async (metaQueue, meta, version) => {\n    const file = meta.files.find(f => f.versions.includes(version) || !!f.versions.find(v => version.handle === v.handle));\n    // precondition for if version no longer exists in meta\n    if (!file)\n        return meta;\n    file.versions = file.versions.filter(v => version !== v && version.handle !== v.handle);\n    if (file.versions.length === 0)\n        metaQueue.push({\n            type: \"remove-file\",\n            payload: file\n        });\n    return meta;\n};\nexport { removeVersion };\n","const addFile = (metaQueue, meta, file) => {\n    const existingFile = meta.files.find(f => file === f || file.name === f.name);\n    if (existingFile) {\n        existingFile.modified = file.modified;\n        existingFile.versions = [...existingFile.versions, ...file.versions];\n    }\n    else {\n        meta.files.push(file);\n    }\n    return meta;\n};\nexport { addFile };\n","const addFolder = (metaQueue, meta, folder) => {\n    const existingFolder = meta.folders.find(f => folder === f || folder.name === f.name);\n    if (!existingFolder)\n        meta.folders.push(folder);\n    return meta;\n};\nexport { addFolder };\n","const removeFolder = async (metaQueue, meta, folder) => {\n    // precondition for if folder is no longer in the metadata\n    if (!meta.folders.find(f => folder === f || folder.name === f.name))\n        return meta;\n    meta.folders = meta.folders.filter(f => folder !== f && folder.name !== f.name);\n    return meta;\n};\nexport { removeFolder };\n","import { NetQueue } from \"../../../../utils/netQueue\";\nimport { getFolderMeta } from \"./getFolderMeta\";\nimport { setFolderMeta } from \"./setFolderMeta\";\nimport { removeFile } from \"./meta/removeFile\";\nimport { removeVersion } from \"./meta/removeVersion\";\nimport { addFile } from \"./meta/addFile\";\nimport { addFolder } from \"./meta/addFolder\";\nimport { removeFolder } from \"./meta/removeFolder\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst createMetaQueue = (masterHandle, dir) => {\n    dir = cleanPath(dir);\n    if (masterHandle.metaQueue[dir])\n        return;\n    const metaQueue = new NetQueue({\n        fetch: async () => {\n            return getFolderMeta(masterHandle, dir);\n        },\n        update: async (meta) => {\n            await setFolderMeta(masterHandle, dir, meta);\n        }\n    });\n    const types = [\n        { type: \"add-folder\", action: addFolder },\n        { type: \"add-file\", action: addFile },\n        { type: \"remove-folder\", action: removeFolder },\n        { type: \"remove-file\", action: removeFile },\n        { type: \"remove-version\", action: removeVersion }\n    ];\n    for (let type of types) {\n        metaQueue.addType({\n            type: type.type,\n            handler: async (meta, payload) => {\n                return await type.action(metaQueue, meta, payload);\n            }\n        });\n    }\n    masterHandle.metaQueue[dir] = metaQueue;\n};\nexport { createMetaQueue };\n","import { util as ForgeUtil } from \"node-forge\";\nimport { hash } from \"../../../../core/hashing\";\nimport { getMetadata } from \"../../../../core/requests/metadata\";\nimport { decrypt } from \"../../../../core/encryption\";\nimport { MinifiedFolderMeta } from \"../../../../core/account/folder-meta\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst getFolderMeta = async (masterHandle, dir) => {\n    dir = cleanPath(dir);\n    createMetaQueue(masterHandle, dir);\n    const folderKey = masterHandle.getFolderHDKey(dir), location = masterHandle.getFolderLocation(dir), key = hash(folderKey.privateKey.toString(\"hex\")), \n    // TODO: verify folder can only be read by the creating account\n    response = await getMetadata(masterHandle.uploadOpts.endpoint, masterHandle, \n    // folderKey,\n    location);\n    try {\n        const metaString = decrypt(key, new ForgeUtil.ByteBuffer(Buffer.from(response.data.metadata, \"base64\"))).toString();\n        try {\n            const meta = JSON.parse(metaString);\n            return new MinifiedFolderMeta(meta).unminify();\n        }\n        catch (err) {\n            console.error(err);\n            console.info(\"META STRING:\", metaString);\n            throw new Error(\"metadata corrupted\");\n        }\n    }\n    catch (err) {\n        console.error(err);\n        throw new Error(\"error decrypting meta\");\n    }\n};\nexport { getFolderMeta };\n","import { getFolderMeta } from \"./getFolderMeta\";\nimport { posix } from \"path-browserify\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst buildFullTree = async (masterHandle, dir = \"/\") => {\n    dir = cleanPath(dir);\n    const tree = {};\n    tree[dir] = await getFolderMeta(masterHandle, dir);\n    await Promise.all(tree[dir].folders.map(async (folder) => {\n        Object.assign(tree, await buildFullTree(masterHandle, posix.join(dir, folder.name)));\n    }));\n    return tree;\n};\nexport { buildFullTree };\n","import { FolderEntryMeta } from \"../../../../core/account/folder-entry\";\nimport { FolderMeta } from \"../../../../core/account/folder-meta\";\nimport { createMetaQueue } from \"./createMetaQueue\";\n// TODO: don't use polyfill\nimport { posix } from \"path-browserify\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst createFolderFn = async (masterHandle, dir, name) => {\n    const fullDir = posix.join(dir, name);\n    if (name.indexOf(\"/\") > 0 || name.length > 2 ** 8)\n        throw new Error(\"Invalid folder name\");\n    // recurively create containing folders first\n    if (!await masterHandle.getFolderMeta(dir).catch(console.warn))\n        await createFolder(masterHandle, posix.dirname(dir), posix.basename(dir));\n    if (await masterHandle.getFolderMeta(fullDir).catch(console.warn))\n        throw new Error(\"Folder already exists\");\n    // initialize as empty folder\n    await masterHandle.createFolderMeta(fullDir).catch(console.warn);\n    await masterHandle.setFolderMeta(fullDir, new FolderMeta({ name }));\n    createMetaQueue(masterHandle, dir);\n    masterHandle.metaQueue[dir].push({\n        type: \"add-folder\",\n        payload: new FolderEntryMeta({\n            name,\n            location: masterHandle.getFolderLocation(fullDir)\n        })\n    });\n};\nconst createFolder = async (masterHandle, dir, name) => {\n    dir = cleanPath(dir);\n    const fullDir = posix.join(dir, name);\n    if (masterHandle.metaFolderCreating[fullDir]) {\n        // TODO: this is hacky\n        await new Promise(resolve => {\n            const interval = setInterval(() => {\n                if (!masterHandle.metaFolderCreating[fullDir]) {\n                    resolve();\n                    clearInterval(interval);\n                }\n            }, 250);\n        });\n        return;\n    }\n    masterHandle.metaFolderCreating[fullDir] = true;\n    await createFolderFn(masterHandle, dir, name);\n    masterHandle.metaFolderCreating[fullDir] = false;\n};\nexport { createFolder };\n","import { createMetadata } from \"../../../../core/requests/metadata\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst createFolderMeta = async (masterHandle, dir) => {\n    dir = cleanPath(dir);\n    try {\n        // TODO: verify folder can only be changed by the creating account\n        await createMetadata(masterHandle.uploadOpts.endpoint, masterHandle, \n        // masterHandle.getFolderHDKey(dir),\n        masterHandle.getFolderLocation(dir));\n    }\n    catch (err) {\n        console.error(`Can't create folder metadata for folder ${dir}`);\n        throw err;\n    }\n};\nexport { createFolderMeta };\n","import Axios from \"axios\";\nimport { getPayload } from \"../request\";\n// Metadata as hexstring as of right now\nexport async function deleteFile(endpoint, hdNode, fileID) {\n    const payload = { fileID };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/delete\", signedPayload);\n}\n","import { deleteFile as requestDeleteFile } from \"../../../../core/requests/deleteFile\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst deleteVersion = async (masterHandle, dir, version) => {\n    dir = cleanPath(dir);\n    await requestDeleteFile(masterHandle.uploadOpts.endpoint, masterHandle, \n    // only send the location, not the private key\n    version.handle.slice(0, 64)).catch(err => {\n        console.warn(\"version does not exist\");\n        console.warn(err);\n    });\n    createMetaQueue(masterHandle, dir);\n    masterHandle.metaQueue[dir].push({\n        type: \"remove-version\",\n        payload: version\n    });\n};\nexport { deleteVersion };\n","import { getFolderMeta } from \"./getFolderMeta\";\nimport { deleteVersion } from \"./deleteVersion\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst deleteFile = async (masterHandle, dir, file) => {\n    dir = cleanPath(dir);\n    const meta = await getFolderMeta(masterHandle, dir);\n    const existingFile = meta.files.find(f => file === f || file.name === f.name);\n    // precondition for if file is no longer in the metadata\n    if (!existingFile)\n        return;\n    for (let version of existingFile.versions) {\n        await deleteVersion(masterHandle, dir, version);\n    }\n    createMetaQueue(masterHandle, dir);\n    masterHandle.metaQueue[dir].push({\n        type: \"remove-file\",\n        payload: existingFile\n    });\n};\nexport { deleteFile };\n","import { createMetaQueue } from \"./createMetaQueue\";\nimport { posix } from \"path-browserify\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst deleteFolder = async (masterHandle, dir, folder) => {\n    dir = cleanPath(dir);\n    const fullDir = posix.join(dir, folder.name);\n    if (folder.name.indexOf(\"/\") > 0 || folder.name.length > 2 ** 8)\n        throw new Error(\"Invalid folder name\");\n    const meta = await masterHandle.getFolderMeta(fullDir).catch(console.warn);\n    if (meta) {\n        await Promise.all([\n            (async () => {\n                try {\n                    for (let folder of meta.folders) {\n                        await masterHandle.deleteFolder(fullDir, folder);\n                    }\n                }\n                catch (err) {\n                    console.error(\"Failed to delete sub folders\");\n                    throw err;\n                }\n            })(),\n            (async () => {\n                try {\n                    for (let file of meta.files) {\n                        await masterHandle.deleteFile(fullDir, file);\n                    }\n                }\n                catch (err) {\n                    console.error(\"Failed to delete file\");\n                    throw err;\n                }\n            })()\n        ]);\n    }\n    try {\n        await masterHandle.deleteFolderMeta(fullDir);\n    }\n    catch (err) {\n        console.error(\"Failed to delete meta entry\");\n        throw err;\n    }\n    createMetaQueue(masterHandle, dir);\n    masterHandle.metaQueue[dir].push({\n        type: \"remove-folder\",\n        payload: folder\n    });\n};\nexport { deleteFolder };\n","import { deleteMetadata } from \"../../../../core/requests/metadata\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst deleteFolderMeta = async (masterHandle, dir) => {\n    dir = cleanPath(dir);\n    // TODO: verify folder can only be changed by the creating account\n    await deleteMetadata(masterHandle.uploadOpts.endpoint, masterHandle, \n    // masterHandle.getFolderHDKey(dir),\n    masterHandle.getFolderLocation(dir));\n};\nexport { deleteFolderMeta };\n","import { checkPaymentStatus } from \"../../../../core/requests/checkPaymentStatus\";\nconst isExpired = async (masterHandle) => {\n    try {\n        const accountInfoResponse = await checkPaymentStatus(masterHandle.uploadOpts.endpoint, masterHandle);\n        return accountInfoResponse.data.paymentStatus == \"expired\";\n    }\n    catch {\n        return false;\n    }\n};\nexport { isExpired };\n","import { FolderMeta } from \"../../../../core/account/folder-meta\";\nimport { getFolderMeta, isPaid } from \"../v0/index\";\nconst login = async (masterHandle) => {\n    // only attempt changes if account is paid\n    if (!await isPaid(masterHandle)) {\n        return;\n    }\n    // try newer meta\n    try {\n        await masterHandle.getFolderMeta(\"/\");\n    }\n    catch (err) {\n        // try older meta\n        try {\n            const meta = await getFolderMeta(masterHandle, \"/\");\n            await masterHandle.deleteFolderMeta(\"/\").catch(console.warn);\n            await masterHandle.createFolderMeta(\"/\").catch(console.warn);\n            console.info(\"--- META ---\", meta);\n            await masterHandle.setFolderMeta(\"/\", new FolderMeta(meta));\n        }\n        catch (err) {\n            // no meta exists\n            // set meta to an empty meta\n            console.warn(err);\n            await masterHandle.createFolderMeta(\"/\").catch(console.warn);\n            await masterHandle.setFolderMeta(\"/\", new FolderMeta());\n        }\n    }\n};\nexport { login };\n","import { getFolderMeta } from \"./getFolderMeta\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst moveFile = async (masterHandle, dir, { file, to }) => {\n    dir = cleanPath(dir);\n    const meta = await getFolderMeta(masterHandle, dir).catch(console.warn), toMeta = await getFolderMeta(masterHandle, to).catch(console.warn);\n    if (!meta)\n        throw new Error(\"Folder does not exist\");\n    if (!toMeta)\n        throw new Error(\"Can't move to folder that doesn't exist\");\n    const existingFile = meta.files.find(f => file === f || file.name === f.name);\n    // file is no longer in the metadata\n    if (!existingFile)\n        throw new Error(\"File no longer exists\");\n    createMetaQueue(masterHandle, dir);\n    createMetaQueue(masterHandle, to);\n    masterHandle.metaQueue[dir].push({\n        type: \"remove-file\",\n        payload: existingFile\n    });\n    masterHandle.metaQueue[to].push({\n        type: \"add-file\",\n        payload: existingFile\n    });\n};\nexport { moveFile };\n","import { getFolderMeta } from \"./getFolderMeta\";\nimport { setFolderMeta } from \"./setFolderMeta\";\nimport { deleteFolderMeta } from \"./deleteFolderMeta\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { createFolderMeta } from \"./createFolderMeta\";\nimport { posix } from \"path-browserify\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst moveFolder = async (masterHandle, dir, { folder, to }) => {\n    dir = cleanPath(dir);\n    const oldDir = posix.join(dir, folder.name), newDir = posix.join(to, folder.name);\n    const folderMeta = await getFolderMeta(masterHandle, oldDir).catch(console.warn), outerMeta = await getFolderMeta(masterHandle, dir).catch(console.warn), toMeta = await getFolderMeta(masterHandle, to).catch(console.warn);\n    if (!folderMeta)\n        throw new Error(\"Folder does not exist\");\n    if (!outerMeta)\n        throw new Error(\"Outer folder does not exist\");\n    if (!toMeta)\n        throw new Error(\"Can't move to folder that doesn't exist\");\n    if (await getFolderMeta(masterHandle, newDir).catch(console.warn))\n        throw new Error(\"Folder already exists\");\n    const existingFolder = outerMeta.folders.find(f => folder === f || folder.name === f.name);\n    // folder is no longer in the metadata\n    if (!existingFolder)\n        throw new Error(\"File no longer exists\");\n    await createFolderMeta(masterHandle, newDir).catch(console.warn);\n    await setFolderMeta(masterHandle, newDir, await getFolderMeta(masterHandle, oldDir));\n    await deleteFolderMeta(masterHandle, oldDir);\n    createMetaQueue(masterHandle, dir);\n    createMetaQueue(masterHandle, to);\n    masterHandle.metaQueue[dir].push({\n        type: \"remove-folder\",\n        payload: existingFolder\n    });\n    masterHandle.metaQueue[to].push({\n        type: \"add-folder\",\n        payload: existingFolder\n    });\n};\nexport { moveFolder };\n","import { getFolderMeta } from \"./getFolderMeta\";\nimport { FileEntryMeta } from \"../../file-entry\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst renameFile = async (masterHandle, dir, { file, name }) => {\n    dir = cleanPath(dir);\n    const meta = await getFolderMeta(masterHandle, dir).catch(console.warn);\n    if (!meta)\n        throw new Error(\"Folder does not exist\");\n    const existingFile = meta.files.find(f => file === f || file.name === f.name);\n    // file is no longer in the metadata\n    if (!existingFile)\n        throw new Error(\"File no longer exists\");\n    createMetaQueue(masterHandle, dir);\n    masterHandle.metaQueue[dir].push({\n        type: \"remove-file\",\n        payload: existingFile\n    });\n    masterHandle.metaQueue[dir].push({\n        type: \"add-file\",\n        payload: new FileEntryMeta({\n            ...existingFile,\n            name\n        })\n    });\n};\nexport { renameFile };\n","import { getFolderMeta } from \"./getFolderMeta\";\nimport { setFolderMeta } from \"./setFolderMeta\";\nimport { deleteFolderMeta } from \"./deleteFolderMeta\";\nimport { getFolderLocation } from \"./index\";\nimport { FolderEntryMeta } from \"../../folder-entry\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { createFolder } from \"./createFolder\";\nimport { posix } from \"path-browserify\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst renameFolder = async (masterHandle, dir, { folder, name }) => {\n    dir = cleanPath(dir);\n    if (name.indexOf(\"/\") > 0 || name.length > 2 ** 8)\n        throw new Error(\"Invalid folder name\");\n    const oldDir = posix.join(dir, folder.name), newDir = posix.join(dir, name);\n    const folderMeta = await getFolderMeta(masterHandle, dir).catch(console.warn), meta = await getFolderMeta(masterHandle, dir).catch(console.warn);\n    if (!folderMeta)\n        throw new Error(\"Folder does not exist\");\n    if (!meta)\n        throw new Error(\"Outer folder does not exist\");\n    if (await getFolderMeta(masterHandle, newDir).catch(console.warn))\n        throw new Error(\"Folder already exists\");\n    const existingFolder = meta.folders.find(f => folder === f || folder.name === f.name);\n    // folder is no longer in the metadata\n    if (!existingFolder)\n        throw new Error(\"Folder no longer exists\");\n    await createFolder(masterHandle, dir, name);\n    await setFolderMeta(masterHandle, newDir, await getFolderMeta(masterHandle, oldDir));\n    await deleteFolderMeta(masterHandle, oldDir);\n    createMetaQueue(masterHandle, dir);\n    masterHandle.metaQueue[dir].push({\n        type: \"remove-folder\",\n        payload: existingFolder\n    });\n    masterHandle.metaQueue[dir].push({\n        type: \"add-folder\",\n        payload: new FolderEntryMeta({\n            name,\n            location: getFolderLocation(masterHandle, newDir)\n        })\n    });\n};\nexport { renameFolder };\n","import Axios from \"axios\";\nimport { getPayload } from \"../request\";\n/**\n * check the status of renewing an account\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to create\n * @param metadataKeys - all metadata keys from the account to renew\n * @param fileHandles - all file handles from the account to renew\n * @param duration - account duration in months\n * @param limit - storage limit in GB\n *\n * @internal\n */\nexport async function renewAccountStatus(endpoint, hdNode, metadataKeys, fileHandles, duration = 12) {\n    const payload = {\n        metadataKeys,\n        fileHandles,\n        durationInMonths: duration\n    };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/renew\", signedPayload);\n}\n/**\n * request an invoice for renewing an account\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to create\n * @param duration - account duration in months\n * @param limit - storage limit in GB\n *\n * @internal\n */\nexport async function renewAccountInvoice(endpoint, hdNode, duration = 12) {\n    const payload = {\n        durationInMonths: duration\n    };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/renew/invoice\", signedPayload);\n}\n","import { renewAccountStatus, renewAccountInvoice } from \"../../../requests/renewAccount\";\nimport { buildFullTree } from \"./buildFullTree\";\nimport { getFolderLocation } from \"../v0/getFolderLocation\";\nconst renewAccount = async (masterHandle, duration) => {\n    const tree = await buildFullTree(masterHandle, \"/\");\n    const metadataKeys = Object.keys(tree).map(dir => getFolderLocation(masterHandle, dir));\n    const fileHandles = Object.values(tree).map(folder => folder.files.map(file => file.versions.map(version => version.handle.slice(0, 64)))).flat(2);\n    console.log(metadataKeys, fileHandles);\n    const renewAccountInvoiceResponse = await renewAccountInvoice(masterHandle.uploadOpts.endpoint, masterHandle, duration);\n    console.log(renewAccountInvoiceResponse);\n    const renewAccountStatusOpts = [\n        masterHandle.uploadOpts.endpoint,\n        masterHandle,\n        metadataKeys,\n        fileHandles,\n        duration\n    ];\n    return {\n        data: renewAccountInvoiceResponse.data,\n        waitForPayment: () => new Promise(resolve => {\n            const interval = setInterval(async () => {\n                // don't perform run if it takes more than 5 seconds for response\n                const time = Date.now();\n                const renewAccountStatusResponse = await renewAccountStatus(...renewAccountStatusOpts);\n                console.log(renewAccountStatusResponse);\n                if (renewAccountStatusResponse.data.status\n                    && renewAccountStatusResponse.data.status !== \"Incomplete\"\n                    && time + 5 * 1000 > Date.now()) {\n                    clearInterval(interval);\n                    await masterHandle.login();\n                    resolve({ data: renewAccountStatusResponse.data });\n                }\n            }, 10 * 1000);\n        })\n    };\n};\nexport { renewAccount };\n","import Axios from \"axios\";\nimport { getPayload } from \"../request\";\n/**\n * check the status of upgrading an account\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to create\n * @param metadataKeys - all metadata keys from the account to upgrade\n * @param fileHandles - all file handles from the account to upgrade\n * @param duration - account duration in months\n * @param limit - storage limit in GB\n *\n * @internal\n */\nexport async function upgradeAccountStatus(endpoint, hdNode, metadataKeys, fileHandles, duration = 12, limit = 128) {\n    const payload = {\n        metadataKeys,\n        fileHandles,\n        durationInMonths: duration,\n        storageLimit: limit\n    };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/upgrade\", signedPayload);\n}\n/**\n * request an invoice for upgrading an account\n *\n * @param endpoint - the base url to send the request to\n * @param hdNode - the account to create\n * @param duration - account duration in months\n * @param limit - storage limit in GB\n *\n * @internal\n */\nexport async function upgradeAccountInvoice(endpoint, hdNode, duration = 12, limit = 128) {\n    const payload = {\n        durationInMonths: duration,\n        storageLimit: limit\n    };\n    const signedPayload = getPayload(payload, hdNode);\n    return Axios.post(endpoint + \"/api/v1/upgrade/invoice\", signedPayload);\n}\n","import { upgradeAccountStatus, upgradeAccountInvoice } from \"../../../requests/upgradeAccount\";\nimport { buildFullTree } from \"./buildFullTree\";\nimport { getFolderLocation } from \"../v0/getFolderLocation\";\nconst upgradeAccount = async (masterHandle, duration, limit) => {\n    const tree = await buildFullTree(masterHandle, \"/\");\n    const metadataKeys = Object.keys(tree).map(dir => getFolderLocation(masterHandle, dir));\n    const fileHandles = Object.values(tree).map(folder => folder.files.map(file => file.versions.map(version => version.handle.slice(0, 64)))).flat(2);\n    console.log(metadataKeys, fileHandles);\n    const upgradeAccountInvoiceResponse = await upgradeAccountInvoice(masterHandle.uploadOpts.endpoint, masterHandle, duration, limit);\n    console.log(upgradeAccountInvoiceResponse);\n    const upgradeAccountStatusOpts = [\n        masterHandle.uploadOpts.endpoint,\n        masterHandle,\n        metadataKeys,\n        fileHandles,\n        duration,\n        limit\n    ];\n    return {\n        data: upgradeAccountInvoiceResponse.data,\n        waitForPayment: () => new Promise(resolve => {\n            const interval = setInterval(async () => {\n                // don't perform run if it takes more than 5 seconds for response\n                const time = Date.now();\n                const upgradeAccountStatusResponse = await upgradeAccountStatus(...upgradeAccountStatusOpts);\n                console.log(upgradeAccountStatusResponse);\n                if (upgradeAccountStatusResponse.data.status\n                    && upgradeAccountStatusResponse.data.status !== \"Incomplete\"\n                    && time + 5 * 1000 > Date.now()) {\n                    clearInterval(interval);\n                    await masterHandle.login();\n                    resolve({ data: upgradeAccountStatusResponse.data });\n                }\n            }, 10 * 1000);\n        })\n    };\n};\nexport { upgradeAccount };\n","import { EventEmitter } from \"events\";\nimport Upload from \"../../../../upload\";\nimport { FileEntryMeta } from \"../../file-entry\";\nimport { FileVersion } from \"../../file-version\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { getFolderMeta } from \"./getFolderMeta\";\nimport { createFolder } from \"./createFolder\";\nimport { posix } from \"path-browserify\";\nimport { cleanPath } from \"../../../../utils/cleanPath\";\nconst uploadFile = (masterHandle, dir, file) => {\n    dir = cleanPath(dir);\n    const upload = new Upload(file, masterHandle, masterHandle.uploadOpts), ee = new EventEmitter();\n    Object.assign(ee, { handle: upload.handle });\n    upload.on(\"upload-progress\", progress => {\n        ee.emit(\"upload-progress\", progress);\n    });\n    upload.on(\"error\", err => {\n        ee.emit(\"error\", err);\n    });\n    upload.on(\"finish\", async (finishedUpload) => {\n        if (!await getFolderMeta(masterHandle, dir).catch(console.warn))\n            await createFolder(masterHandle, posix.dirname(dir), posix.basename(dir));\n        createMetaQueue(masterHandle, dir);\n        masterHandle.metaQueue[dir].push({\n            type: \"add-file\",\n            payload: new FileEntryMeta({\n                name: file.name,\n                modified: file.lastModified,\n                versions: [\n                    new FileVersion({\n                        handle: finishedUpload.handle,\n                        size: file.size,\n                        modified: file.lastModified\n                    })\n                ]\n            })\n        });\n        masterHandle.metaQueue[dir].once(\"update\", meta => {\n            ee.emit(\"finish\", finishedUpload);\n        });\n    });\n    return ee;\n};\nexport { uploadFile };\n","import { downloadFile } from \"../v0/downloadFile\";\nimport { generateSubHDKey } from \"../v0/generateSubHDKey\";\nimport { getAccountInfo } from \"../v0/getAccountInfo\";\nimport { getFolderHDKey } from \"../v0/getFolderHDKey\";\nimport { getFolderLocation } from \"../v0/getFolderLocation\";\nimport { getHandle } from \"../v0/getHandle\";\nimport { isPaid } from \"../v0/isPaid\";\nimport { register } from \"../v0/register\";\nimport { buildFullTree } from \"./buildFullTree\";\nimport { createFolder } from \"./createFolder\";\nimport { createFolderMeta } from \"./createFolderMeta\";\nimport { createMetaQueue } from \"./createMetaQueue\";\nimport { deleteFile } from \"./deleteFile\";\nimport { deleteFolder } from \"./deleteFolder\";\nimport { deleteFolderMeta } from \"./deleteFolderMeta\";\nimport { deleteVersion } from \"./deleteVersion\";\nimport { getFolderMeta } from \"./getFolderMeta\";\nimport { isExpired } from \"./isExpired\";\nimport { login } from \"./login\";\nimport { moveFile } from \"./moveFile\";\nimport { moveFolder } from \"./moveFolder\";\nimport { renameFile } from \"./renameFile\";\nimport { renameFolder } from \"./renameFolder\";\nimport { renewAccount } from \"./renewAccount\";\nimport { setFolderMeta } from \"./setFolderMeta\";\nimport { upgradeAccount } from \"./upgradeAccount\";\nimport { uploadFile } from \"./uploadFile\";\nexport { downloadFile, generateSubHDKey, getAccountInfo, getFolderHDKey, getFolderLocation, getHandle, isPaid, register, buildFullTree, createFolder, createFolderMeta, createMetaQueue, deleteFile, deleteFolder, deleteFolderMeta, deleteVersion, getFolderMeta, isExpired, login, moveFile, moveFolder, renameFile, renameFolder, renewAccount, setFolderMeta, upgradeAccount, uploadFile };\n/**\n * internal API v1\n *\n * @internal\n */\nconst v1 = {\n    downloadFile,\n    generateSubHDKey,\n    getAccountInfo,\n    getFolderHDKey,\n    getFolderLocation,\n    getHandle,\n    isPaid,\n    register,\n    buildFullTree,\n    createFolder,\n    createFolderMeta,\n    createMetaQueue,\n    deleteFile,\n    deleteFolder,\n    deleteFolderMeta,\n    deleteVersion,\n    getFolderMeta,\n    isExpired,\n    login,\n    moveFile,\n    moveFolder,\n    renameFile,\n    renameFolder,\n    renewAccount,\n    setFolderMeta,\n    upgradeAccount,\n    uploadFile\n};\nexport default v1;\n","import { generateMnemonic, mnemonicToSeedSync, validateMnemonic, } from \"bip39\";\nimport HDKey, { fromMasterSeed } from \"hdkey\";\nimport * as namehash from \"eth-ens-namehash\";\nimport { hashToPath } from \"./utils/hashToPath\";\nimport { buildFullTree, createFolder, createFolderMeta, deleteFile, deleteFolder, deleteFolderMeta, deleteVersion, downloadFile, generateSubHDKey, getAccountInfo, getFolderHDKey, getFolderLocation, getFolderMeta, getHandle, isExpired, isPaid, login, moveFile, moveFolder, register, renameFile, renameFolder, renewAccount, setFolderMeta, uploadFile, upgradeAccount } from \"./core/account/api/v1/index\";\n/**\n * <b><i>this should never be shared or left in storage</i></b><br />\n *\n * a class for representing the account mnemonic\n *\n * @public\n */\nclass Account {\n    /**\n     * creates an account from a mnemonic if provided, otherwise from entropy\n     *\n     * @param mnemonic - the mnemonic to use for the account\n     */\n    constructor(mnemonic = generateMnemonic()) {\n        if (!validateMnemonic(mnemonic)) {\n            throw new Error(\"mnemonic provided was not valid\");\n        }\n        this._mnemonic = mnemonic;\n    }\n    get mnemonic() {\n        return this._mnemonic.trim().split(/\\s+/g);\n    }\n    get seed() {\n        return mnemonicToSeedSync(this._mnemonic);\n    }\n}\n/**\n * <b><i>this should never be shared or left in storage</i></b><br />\n *\n * a class for creating a master handle from an account mnemonic\n *\n * @remarks\n *\n * a master handle is responsible for:\n *  <br /> - logging in to an account\n *  <br /> - signing changes for the account\n *  <br /> - deterministic entropy for generating features of an account (such as folder keys)\n *\n * @public\n */\nclass MasterHandle extends HDKey {\n    /**\n     * creates a master handle from an account\n     *\n     * @param _ - the account to generate the handle from\n     * @param _.account - an {@link Account}\n     * @param _.handle - an account handle as a string\n     */\n    constructor({ account, handle, }, { uploadOpts = {}, downloadOpts = {} } = {}) {\n        super();\n        this.metaQueue = {};\n        this.metaFolderCreating = {};\n        /**\n         * creates a sub key seed for validating\n         *\n         * @param path - the string to use as a sub path\n         */\n        this.generateSubHDKey = (pathString) => generateSubHDKey(this, pathString);\n        this.uploadFile = (dir, file) => uploadFile(this, dir, file);\n        this.downloadFile = (handle) => downloadFile(this, handle);\n        /**\n         * deletes every version of a file and removes it from the metadata\n         *\n         * @param dir - the containing folder\n         * @param file - file entry to delete (loosely matched name)\n         */\n        this.deleteFile = (dir, file) => deleteFile(this, dir, file);\n        /**\n         * deletes a single version of a file (ie. delete by handle)\n         *\n         * @param dir - the containing folder\n         * @param version - version to delete (loosely matched by handle)\n         */\n        this.deleteVersion = (dir, version) => deleteVersion(this, dir, version);\n        /**\n         * creates a dir key seed for validating and folder navigation\n         *\n         * @param dir - the folder\n         */\n        this.getFolderHDKey = (dir) => getFolderHDKey(this, dir);\n        /**\n         * get the location (ie. metadata id) of a folder\n         *\n         * @remarks this is a deterministic location derived from the account's hdkey to allow for random folder access\n         *\n         * @param dir - the folder to locate\n         */\n        this.getFolderLocation = (dir) => getFolderLocation(this, dir);\n        /**\n         * request the creation of a folder metadata\n         *\n         * @param dir - the folder to create\n         */\n        this.createFolderMeta = async (dir) => createFolderMeta(this, dir);\n        /**\n         * create folder {name} inside of {dir}\n         *\n         * @param dir - the containing folder\n         * @param name - the name of the new folder\n         */\n        this.createFolder = async (dir, name) => createFolder(this, dir, name);\n        this.deleteFolderMeta = async (dir) => deleteFolderMeta(this, dir);\n        this.deleteFolder = async (dir, folder) => deleteFolder(this, dir, folder);\n        this.moveFile = async (dir, { file, to }) => moveFile(this, dir, { file, to });\n        this.moveFolder = async (dir, { folder, to }) => moveFolder(this, dir, { folder, to });\n        this.renameFile = async (dir, { file, name }) => renameFile(this, dir, { file, name });\n        this.renameFolder = async (dir, { folder, name }) => renameFolder(this, dir, { folder, name });\n        this.setFolderMeta = async (dir, folderMeta) => setFolderMeta(this, dir, folderMeta);\n        this.getFolderMeta = async (dir) => getFolderMeta(this, dir);\n        /**\n         * recursively build full file tree starting from directory {dir}\n         *\n         * @param dir - the starting directory\n         */\n        this.buildFullTree = async (dir) => buildFullTree(this, dir);\n        this.getAccountInfo = async () => getAccountInfo(this);\n        this.isExpired = async () => isExpired(this);\n        this.isPaid = async () => isPaid(this);\n        this.login = async () => login(this);\n        this.register = async (duration, limit) => register(this, duration, limit);\n        this.upgrade = async (duration, limit) => upgradeAccount(this, duration, limit);\n        this.renew = async (duration) => renewAccount(this, duration);\n        this.uploadOpts = uploadOpts;\n        this.downloadOpts = downloadOpts;\n        if (account && account.constructor == Account) {\n            const path = \"m/43'/60'/1775'/0'/\" + hashToPath(namehash.hash(\"opacity.io\").replace(/^0x/, \"\"));\n            // ethereum/EIPs#1775\n            Object.assign(this, fromMasterSeed(account.seed).derive(path));\n        }\n        else if (handle && handle.constructor == String) {\n            this.privateKey = Buffer.from(handle.slice(0, 64), \"hex\");\n            this.chainCode = Buffer.from(handle.slice(64), \"hex\");\n        }\n        else {\n            throw new Error(\"master handle was not of expected type\");\n        }\n    }\n    /**\n     * get the account handle\n     */\n    get handle() {\n        return getHandle(this);\n    }\n}\nexport { Account, MasterHandle, HDKey };\n"],"names":["DEFAULT_OPTIONS","Object","freeze","objectMode","FileSourceStream","Readable","constructor","blob","options","opts","assign","console","log","offset","reader","FileReader","_onChunkRead","bind","blockSize","Error","_read","readyState","LOADING","_readChunkFromBlob","limit","Math","min","size","push","chunk","slice","onload","readAsArrayBuffer","event","target","result","Uint8Array","BufferSourceStream","data","buffer","read","_readChunkFromBuffer","buf","length","FILENAME_MAX_LENGTH","IV_BYTE_LENGTH","TAG_BYTE_LENGTH","TAG_BIT_LENGTH","DEFAULT_BLOCK_SIZE","BLOCK_OVERHEAD","DEFAULT_PART_SIZE","Forge","md","ForgeMd","random","ForgeRandom","util","ForgeUtil","ByteBuffer","generateFileKeys","hash","sha256","create","update","getBytesSync","digest","toHex","key","handle","keysFromHandle","bytes","binary","hex","decode","getBytes","bytesToHex","sanitizeFilename","filename","l","start","substring","end","getFileData","file","nameFallback","isBuffer","name","type","mime","getType","getMimeType","metadata","getUploadSize","params","blockCount","ceil","getEndIndex","uploadSize","partSize","chunkSize","chunkCount","chunksPerPart","endIndex","getBlockSize","p","cipher","ForgeCipher","encrypt","byteBuffer","keyBuf","Buffer","from","iv","createCipher","tagLength","finish","clear","putBuffer","output","mode","tag","putBytes","encryptString","string","encoding","createBuffer","encryptBytes","decrypt","decipher","createDecipher","truncate","decryptBytes","raw","decryptString","toString","createMetadata","encryptMetadata","encryptedMeta","JSON","stringify","decryptMetadata","byteStr","encode","meta","parse","binaryMode","DecryptStream","Transform","iter","_transform","callback","emit","autostart","maxParallelDownloads","maxRetries","DownloadStream","url","chunks","chunkId","pushId","bytesDownloaded","isDownloadFinished","ongoingDownloads","pushChunk","floor","_download","attemptDownload","_pushChunk","chunkIndex","index","range","id","download","Axios","get","responseType","headers","error","_afterDownload","METADATA_PATH","autoStart","Download","EventEmitter","_metadata","downloadMetadata","toBuffer","totalLength","startDownload","Promise","resolve","decryptStream","on","once","concat","catch","err","toFile","File","getDownloadURL","downloadFile","e","propagateError","overwrite","req","downloadURLRequest","post","endpoint","fileID","res","status","downloadURL","fileDownloadUrl","metadataRequest","path","isDownloading","downloadStream","progress","pipe","finishDownload","warn","message","process","nextTick","EncryptStream","getPlans","checkPaymentStatus","hdNode","payload","timestamp","Date","now","signedPayload","getPayload","createAccount","metadataKey","duration","durationInMonths","storageLimit","deleteMetadata","setMetadata","getMetadata","POLYFILL_FORMDATA","FormData","rawPayload","EthUtil","signature","sign","pubKey","publicKey","getPayloadFD","extraPayload","FormDataNode","append","keys","forEach","pl","contentType","knownLength","Blob","maxParallelUploads","UploadStream","Writable","account","bytesUploaded","blockBuffer","partBuffer","bufferSize","ongoingUploads","retries","partIndex","finalCallback","_write","_addPart","_attemptUpload","_final","_finishUpload","blocks","block","shift","set","part","_upload","cork","fileHandle","chunkData","upload","getHeaders","onUploadProgress","then","_afterUpload","_uploadError","uncork","confirmUpload","_confirmUpload","uploadFinished","setTimeout","missingIndexes","DEFAULT_FILE_PARAMS","Upload","startUpload","uploadMetadata","uploadFile","fileSizeInByte","readStream","encryptStream","uploadStream","finishUpload","masterHandle","downloadOpts","val","soliditySha3","replace","hashToPath","h","prefix","match","map","parseInt","join","generateSubHDKey","pathString","derive","getAccountInfo","uploadOpts","posixSep","RegExp","posix","sep","posixSepEnd","win32Sep","trimTrailingSep","cleanPath","getFolderHDKey","dir","getFolderLocation","getFolderMeta","folderKey","location","privateKey","response","metaString","info","getHandle","chainCode","isPaid","accountInfoResponse","paymentStatus","register","invoice","cost","ethAddress","waitForPayment","createAccountResponse","interval","setInterval","time","clearInterval","login","v0","FileVersion","created","modified","minify","MinifiedFileVersion","Array","unminify","FileEntryMeta","versions","MinifiedFileEntryMeta","version","FolderEntryMeta","MinifiedFolderEntryMeta","FolderMeta","files","folders","MinifiedFolderMeta","folder","NetQueue","fetch","timeout","updating","queue","types","_process","addType","handler","debounce","queueCopy","_fetch","_update","_timeout","setFolderMeta","folderMeta","removeFile","metaQueue","find","f","filter","removeVersion","includes","v","addFile","existingFile","addFolder","existingFolder","removeFolder","createMetaQueue","action","buildFullTree","tree","all","createFolderFn","fullDir","indexOf","createFolder","dirname","basename","createFolderMeta","metaFolderCreating","deleteFile","deleteVersion","requestDeleteFile","deleteFolder","deleteFolderMeta","isExpired","moveFile","to","toMeta","moveFolder","oldDir","newDir","outerMeta","renameFile","renameFolder","renewAccountStatus","metadataKeys","fileHandles","renewAccountInvoice","renewAccount","values","flat","renewAccountInvoiceResponse","renewAccountStatusOpts","renewAccountStatusResponse","upgradeAccountStatus","upgradeAccountInvoice","upgradeAccount","upgradeAccountInvoiceResponse","upgradeAccountStatusOpts","upgradeAccountStatusResponse","ee","finishedUpload","lastModified","v1","Account","mnemonic","generateMnemonic","validateMnemonic","_mnemonic","trim","split","seed","mnemonicToSeedSync","MasterHandle","HDKey","upgrade","renew","namehash","fromMasterSeed","String"],"mappings":"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"}